{"model_class":"Job","id":"bbd44e69cb8906b5cb776f6840f2d71d","history_id":"bbd44e69cb8906b564fe30d18ba75f5b","tool_id":"toolshed.g2.bx.psu.edu/repos/goeckslab/image_learner/image_learner/0.1.5","state":"ok","exit_code":0,"create_time":"2026-02-08T21:20:43.123226","update_time":"2026-02-08T21:44:17.735739","galaxy_version":"25.1","external_id":null,"handler":null,"job_runner_name":null,"command_line":"ln -sf '/jetstream2/scratch/main/jobs/74484141/inputs/dataset_9fc0562f-c8b3-420e-964e-fb5276ecee49.dat' \"./selected_HAM10000_img_metadata_aug.csv\"; mkdir -p \"./torch_cache\";   python '/jetstream2/scratch/main/jobs/74484141/tool_files/image_learner_cli.py' --csv-file \"./selected_HAM10000_img_metadata_aug.csv\" --image-zip \"/jetstream2/scratch/main/jobs/74484141/inputs/dataset_d4e20b36-bb9f-4cf1-befd-9d5161166830.dat\" --model-name \"caformer_s18_384\" --use-pretrained --fine-tune --epochs \"30\" --early-stop \"30\" --split-probabilities \"0.7\" \"0.1\" \"0.2\" --threshold \"0.5\" --augmentation \"random_horizontal_flip,random_vertical_flip,random_rotate,random_blur,random_brightness,random_contrast\" --target-column \"3\" --image-column \"8\" --sample-id-column \"1\" --image-resize \"384x384\" --random-seed \"42\" --torch-home \"./torch_cache\" --output-dir \".\" &&  mkdir -p '/jetstream2/scratch/main/jobs/74484141/outputs/dataset_50f6a43f-cba9-4ddd-8445-90a666e95de0_files' && cp -r experiment_run/model/*.json experiment_run/model/model_weights '/jetstream2/scratch/main/jobs/74484141/outputs/dataset_50f6a43f-cba9-4ddd-8445-90a666e95de0_files' &&  echo \"Image Learner Classification Experiment is Done!\"","user_email":null,"user_id":"92401dda9a0b9e33","command_version":"","params":{"task_selection":"{\"__current_case__\": 1, \"task\": \"classification\", \"validation_metric_multiclass\": \"\"}","column_override":"{\"__current_case__\": 0, \"image_column\": \"8\", \"override_columns\": \"true\", \"target_column\": \"3\"}","sample_id_column":"\"1\"","model_name":"\"caformer_s18_384\"","scratch_fine_tune":"{\"__current_case__\": 0, \"fine_tune\": \"true\", \"use_pretrained\": \"true\"}","image_resize":"\"384x384\"","augmentation":"[\"random_horizontal_flip\", \"random_vertical_flip\", \"random_rotate\", \"random_blur\", \"random_brightness\", \"random_contrast\"]","random_seed":"\"42\"","advanced_settings":"{\"__current_case__\": 0, \"batch_size_condition\": {\"__current_case__\": 1, \"batch_size_define\": \"false\"}, \"customize_defaults\": \"true\", \"early_stop\": \"30\", \"epochs\": \"30\", \"learning_rate_condition\": {\"__current_case__\": 1, \"learning_rate_define\": \"false\"}, \"test_split\": \"0.2\", \"threshold\": \"0.5\", \"train_split\": \"0.7\", \"val_split\": \"0.1\"}","chromInfo":"\"/cvmfs/data.galaxyproject.org/managed/len/ucsc/?.len\"","dbkey":"\"?\"","__input_ext":"\"input\""},"inputs":{"input_csv":{"id":"f9cad7b01a4721356f89ac2d0ba55d36","src":"hda","uuid":"9fc0562f-c8b3-420e-964e-fb5276ecee49"},"image_zip":{"id":"f9cad7b01a4721353cdecbe582bebf01","src":"hda","uuid":"d4e20b36-bb9f-4cf1-befd-9d5161166830"}},"outputs":{"output_model":{"id":"f9cad7b01a472135bb403bfe62baf57d","src":"hda","uuid":"50f6a43f-cba9-4ddd-8445-90a666e95de0"},"output_report":{"id":"f9cad7b01a4721352fae0b179f1e19a9","src":"hda","uuid":"623c02d7-dada-4d33-8c5c-5b2e51064d62"},"__new_primary_file_output_pred_csv|ISIC_0026827_flip_gradcam__":{"id":"f9cad7b01a4721351f53d0b42600c260","src":"hda","uuid":"53b51e51-afb7-4d67-915d-bd98ab65d51c"},"__new_primary_file_output_pred_csv|ISIC_0026827_flip_original__":{"id":"f9cad7b01a472135b456a6eabdd4573c","src":"hda","uuid":"46a612ed-c94b-4379-bd26-a6bf369b9ecc"},"__new_primary_file_output_pred_csv|ISIC_0026827_orig_gradcam__":{"id":"f9cad7b01a472135db796b2495a1eeca","src":"hda","uuid":"65de99b9-47de-4326-947f-a01701ff7b10"},"__new_primary_file_output_pred_csv|ISIC_0026827_orig_original__":{"id":"f9cad7b01a47213522a070426c8860f9","src":"hda","uuid":"c9e3f019-04f3-4511-ade1-487c9ce85a4e"},"__new_primary_file_output_pred_csv|ISIC_0027419_flip_gradcam__":{"id":"f9cad7b01a472135a05d409fa2547ef3","src":"hda","uuid":"14247d1f-722d-4fb7-9540-fbfc90de4f86"},"__new_primary_file_output_pred_csv|ISIC_0027419_flip_original__":{"id":"f9cad7b01a47213530dd0a35e52d6453","src":"hda","uuid":"7fb668a6-2535-4fbd-876b-9066dc3a049f"},"__new_primary_file_output_pred_csv|ISIC_0027419_orig_gradcam__":{"id":"f9cad7b01a472135b0cf8a894d37ffd0","src":"hda","uuid":"4fb3cae1-fe63-47fb-a5b6-58643cf45c02"},"__new_primary_file_output_pred_csv|ISIC_0027419_orig_original__":{"id":"f9cad7b01a472135c7e074214f3e697b","src":"hda","uuid":"599c6eff-96a6-43c9-9994-b89fe0d40c4b"},"__new_primary_file_output_pred_csv|ISIC_0028308_flip_gradcam__":{"id":"f9cad7b01a472135821965836236803e","src":"hda","uuid":"4948cca3-6235-4046-9159-2546d20cd31a"},"__new_primary_file_output_pred_csv|ISIC_0028308_flip_original__":{"id":"f9cad7b01a4721358165b5ba2b445b6b","src":"hda","uuid":"766a12a0-3a21-4656-8ff7-d0d38ed12cfc"},"__new_primary_file_output_pred_csv|ISIC_0028308_orig_gradcam__":{"id":"f9cad7b01a472135c912719cf7a252c2","src":"hda","uuid":"a5eea3d0-c8b2-4204-8817-f5468825feaf"},"__new_primary_file_output_pred_csv|ISIC_0028308_orig_original__":{"id":"f9cad7b01a472135b68ee5c10dc9e1ce","src":"hda","uuid":"61f6b8ac-8431-45c3-823c-152fb8ec1179"},"__new_primary_file_output_pred_csv|ISIC_0032877_flip_gradcam__":{"id":"f9cad7b01a4721356030a745b25f1dc3","src":"hda","uuid":"8c8030a9-bf73-4dc4-9dc0-479716ea334b"},"__new_primary_file_output_pred_csv|ISIC_0032877_flip_original__":{"id":"f9cad7b01a4721353adda00a405f3fbe","src":"hda","uuid":"aa08e815-2a7e-414a-bac1-922366af18b4"},"__new_primary_file_output_pred_csv|ISIC_0032877_orig_gradcam__":{"id":"f9cad7b01a47213561bcf283ffe730b5","src":"hda","uuid":"4c71d7c9-1a3a-4fb9-99f0-2ebff4696e34"},"__new_primary_file_output_pred_csv|ISIC_0032877_orig_original__":{"id":"f9cad7b01a472135a7e1d928955c3e77","src":"hda","uuid":"2cf8d0f3-969a-4df4-9c76-6070b4327ea5"},"__new_primary_file_output_pred_csv|ISIC_0034003_flip_gradcam__":{"id":"f9cad7b01a472135455795fbc0dab2d5","src":"hda","uuid":"932405bd-c5f7-402f-8240-3ce21582f034"},"__new_primary_file_output_pred_csv|ISIC_0034003_flip_original__":{"id":"f9cad7b01a4721353b2724ee1d01f0be","src":"hda","uuid":"68edd1cd-917d-4e30-ae90-41f2bb4510d4"},"__new_primary_file_output_pred_csv|ISIC_0034003_orig_gradcam__":{"id":"f9cad7b01a472135fd51d8dad40ee273","src":"hda","uuid":"e6745c09-484c-42ab-8a35-197ae12f0cd5"},"__new_primary_file_output_pred_csv|ISIC_0034003_orig_original__":{"id":"f9cad7b01a47213591d86e4be61ae099","src":"hda","uuid":"e7c83920-6efc-42a3-935c-37450b94c006"},"__new_primary_file_output_pred_csv|description__":{"id":"f9cad7b01a4721352fa6f3168538a31f","src":"hda","uuid":"b9f40f14-ab93-49ef-8f5f-feed871c245a"},"__new_primary_file_output_pred_csv|predictions.shapes__":{"id":"f9cad7b01a472135946ed8280d91d2c5","src":"hda","uuid":"096ae3a7-ce23-4727-8f5e-7c5f14ae7e1d"},"__new_primary_file_output_pred_csv|test_statistics__":{"id":"f9cad7b01a4721351f0cb106b9b0a281","src":"hda","uuid":"2c8c1972-b4a9-4239-bed5-7e951dd5c90d"},"__new_primary_file_output_pred_csv|training_statistics__":{"id":"f9cad7b01a472135323206f91c2fd132","src":"hda","uuid":"fb88c2e8-cdd9-4e75-922f-be8b02322273"},"__new_primary_file_output_pred_csv|ISIC_0025063_flip_gradcam__":{"id":"f9cad7b01a472135abf1d2764a8da60b","src":"hda","uuid":"956618aa-e9b5-4ab3-9553-671f973ddd0b"},"__new_primary_file_output_pred_csv|ISIC_0025063_flip_original__":{"id":"f9cad7b01a4721353a5488740ec54cb7","src":"hda","uuid":"e8df0438-7edb-4180-b2d7-b750f67177aa"},"__new_primary_file_output_pred_csv|ISIC_0025063_orig_gradcam__":{"id":"f9cad7b01a47213550b9f97ac4995bfa","src":"hda","uuid":"be42feb1-4d25-4f42-b0ef-552c44f3400c"},"__new_primary_file_output_pred_csv|ISIC_0025063_orig_original__":{"id":"f9cad7b01a47213592d69af68336c906","src":"hda","uuid":"d1523425-a7af-4d61-a0d0-833cbd029a65"}},"copied_from_job_id":null,"output_collections":{"output_pred_csv":{"src":"hdca","id":"58b62ff8b158e75a"}},"tool_stdout":"MetaFormer models imported successfully\nPyTorch version 2.1.0+cu118 available.\ngenerated new fontManager\nLudwig visualizations available\nMetaFormer patching applied for Ludwig stacked_cnn encoder.\nOrchestrator initialized with backend: LudwigDirectBackend\nStarting workflow...\nCreated temp directory: gleam_image_work_22ulxkps\nPreparing images from /jetstream2/scratch/main/jobs/74484141/inputs/dataset_d4e20b36-bb9f-4cf1-befd-9d5161166830.dat → gleam_image_work_22ulxkps/images\nImage extraction complete.\nLoading metadata table from selected_HAM10000_img_metadata_aug.csv\nLoaded metadata file: selected_HAM10000_img_metadata_aug.csv\nTarget column '3' not found; using column #3 header 'dx' instead.\nImage column '8' not found; using column #8 header 'image_path' instead.\nSample ID column '1' not found; using column #1 header 'lesion_id' instead.\nNo split column; creating stratified random split\nUsing stratified random split for train/validation/test sets (grouped by 'lesion_id')\nSuccessfully applied stratified random split\nSplit counts: Train=978, Val=140, Test=282\nSaved prepared data to gleam_image_work_22ulxkps/processed_data_for_ludwig.csv\nLudwigDirectBackend: Preparing YAML configuration.\nDETECTED MetaFormer model: caformer_s18_384\nMetaFormer cfg lookup: model=caformer_s18_384 has_cfg=True url=https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth use_pretrained=True\nMetaFormer explicit resize: 384x384\nSet preprocessing dimensions for MetaFormer: 384x384 (infer_dimensions=True with max dimensions to allow validation)\nLudwigDirectBackend: YAML config generated.\nWrote backend config: gleam_image_work_22ulxkps/ludwig_config.yaml\nLudwigDirectBackend: Starting experiment execution.\nDisabled torchvision weight hash verification to avoid proxy-corrupted downloads.\n\n╒════════════════════════╕\n│ EXPERIMENT DESCRIPTION │\n╘════════════════════════╛\n\n╒══════════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════════════════╕\n│ Experiment name  │ experiment                                                                                                  │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ Model name       │ run                                                                                                         │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ Output directory │ /jetstream2/scratch/main/jobs/74484141/working/experiment_run                                               │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ ludwig_version   │ '0.10.1'                                                                                                    │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ command          │ ('/jetstream2/scratch/main/jobs/74484141/tool_files/image_learner_cli.py '                                  │\n│                  │  '--csv-file ./selected_HAM10000_img_metadata_aug.csv --image-zip '                                         │\n│                  │  '/jetstream2/scratch/main/jobs/74484141/inputs/dataset_d4e20b36-bb9f-4cf1-befd-9d5161166830.dat '          │\n│                  │  '--model-name caformer_s18_384 --use-pretrained --fine-tune --epochs 30 '                                  │\n│                  │  '--early-stop 30 --split-probabilities 0.7 0.1 0.2 --threshold 0.5 '                                       │\n│                  │  '--augmentation '                                                                                          │\n│                  │  'random_horizontal_flip,random_vertical_flip,random_rotate,random_blur,random_brightness,random_contrast ' │\n│                  │  '--target-column 3 --image-column 8 --sample-id-column 1 --image-resize '                                  │\n│                  │  '384x384 --random-seed 42 --torch-home ./torch_cache --output-dir .')                                      │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ random_seed      │ 42                                                                                                          │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ dataset          │ 'gleam_image_work_22ulxkps/processed_data_for_ludwig.csv'                                                   │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ data_format      │ 'csv'                                                                                                       │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ torch_version    │ '2.1.0+cu118'                                                                                               │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ compute          │ {   'arch_list': [   'sm_50',                                                                               │\n│                  │                      'sm_60',                                                                               │\n│                  │                      'sm_70',                                                                               │\n│                  │                      'sm_75',                                                                               │\n│                  │                      'sm_80',                                                                               │\n│                  │                      'sm_86',                                                                               │\n│                  │                      'sm_37',                                                                               │\n│                  │                      'sm_90'],                                                                              │\n│                  │     'devices': {   0: {   'device_capability': (8, 0),                                                      │\n│                  │                           'device_properties': \"_CudaDeviceProperties(name='GRID \"                          │\n│                  │                                                \"A100X-20C', major=8, minor=0, \"                             │\n│                  │                                                'total_memory=20475MB, '                                     │\n│                  │                                                'multi_processor_count=108)',                                │\n│                  │                           'gpu_type': 'GRID A100X-20C'}},                                                   │\n│                  │     'gencode_flags': '-gencode compute=compute_50,code=sm_50 -gencode '                                     │\n│                  │                      'compute=compute_60,code=sm_60 -gencode '                                              │\n│                  │                      'compute=compute_70,code=sm_70 -gencode '                                              │\n│                  │                      'compute=compute_75,code=sm_75 -gencode '                                              │\n│                  │                      'compute=compute_80,code=sm_80 -gencode '                                              │\n│                  │                      'compute=compute_86,code=sm_86 -gencode '                                              │\n│                  │                      'compute=compute_37,code=sm_37 -gencode '                                              │\n│                  │                      'compute=compute_90,code=sm_90',                                                       │\n│                  │     'gpus_per_node': 1,                                                                                     │\n│                  │     'num_nodes': 1}                                                                                         │\n╘══════════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════════════════╛\n\n╒═══════════════╕\n│ LUDWIG CONFIG │\n╘═══════════════╛\n\nUser-specified config (with upgrades):\n\n{   'combiner': {'type': 'concat'},\n    'input_features': [   {   'augmentation': [   {   'type': 'random_horizontal_flip'},\n                                                  {   'type': 'random_vertical_flip'},\n                                                  {   'degree': 10,\n                                                      'type': 'random_rotate'},\n                                                  {   'kernel_size': 3,\n                                                      'type': 'random_blur'},\n                                                  {   'max': 2.0,\n                                                      'min': 0.5,\n                                                      'type': 'random_brightness'},\n                                                  {   'max': 2.0,\n                                                      'min': 0.5,\n                                                      'type': 'random_contrast'}],\n                              'encoder': {   'custom_model': 'caformer_s18_384',\n                                             'height': 384,\n                                             'num_channels': 3,\n                                             'output_size': 128,\n                                             'trainable': True,\n                                             'type': 'stacked_cnn',\n                                             'use_pretrained': True,\n                                             'width': 384},\n                              'name': 'image_path',\n                              'preprocessing': {   'height': 384,\n                                                   'infer_image_dimensions': True,\n                                                   'infer_image_max_height': 384,\n                                                   'infer_image_max_width': 384,\n                                                   'num_channels': 3,\n                                                   'requires_equal_dimensions': False,\n                                                   'resize_method': 'interpolate',\n                                                   'standardize_image': 'imagenet1k',\n                                                   'width': 384},\n                              'type': 'image'}],\n    'ludwig_version': '0.10.1',\n    'model_type': 'ecd',\n    'output_features': [   {   'loss': {   'class_weights': None,\n                                           'type': 'softmax_cross_entropy'},\n                               'name': 'label',\n                               'type': 'category'}],\n    'preprocessing': {   'in_memory': False,\n                         'num_processes': 8,\n                         'split': {'column': 'split', 'type': 'fixed'}},\n    'trainer': {   'batch_size': 'auto',\n                   'early_stop': 30,\n                   'epochs': 30,\n                   'learning_rate': 'auto',\n                   'validation_metric': 'accuracy'}}\n\nFull config saved to:\n/jetstream2/scratch/main/jobs/74484141/working/experiment_run/experiment/model/model_hyperparameters.json\n\n╒═══════════════╕\n│ PREPROCESSING │\n╘═══════════════╛\n\nNo cached dataset found at gleam_image_work_22ulxkps/processed_data_for_ludwig.training.hdf5. Preprocessing the dataset.\nUsing full raw dataset, no hdf5 and json file with the same name have been found\nBuilding dataset (it may take a while)\nBuilding dataset: DONE\nWriting preprocessed training set cache to gleam_image_work_22ulxkps/processed_data_for_ludwig.training.hdf5\nWriting preprocessed validation set cache to gleam_image_work_22ulxkps/processed_data_for_ludwig.validation.hdf5\nWriting preprocessed test set cache to gleam_image_work_22ulxkps/processed_data_for_ludwig.test.hdf5\nWriting train set metadata to gleam_image_work_22ulxkps/processed_data_for_ludwig.meta.json\n\nDataset Statistics\n╒════════════╤═══════════════╤════════════════════╕\n│ Dataset    │   Size (Rows) │ Size (In Memory)   │\n╞════════════╪═══════════════╪════════════════════╡\n│ Training   │           978 │ 146.25 Kb          │\n├────────────┼───────────────┼────────────────────┤\n│ Validation │           140 │ 21.04 Kb           │\n├────────────┼───────────────┼────────────────────┤\n│ Test       │           282 │ 42.26 Kb           │\n╘════════════╧═══════════════╧════════════════════╛\n\n╒═══════╕\n│ MODEL │\n╘═══════╛\n\nWarnings and other logs:\npatched Stacked2DCNN init called; custom_model=caformer_s18_384 kwargs_keys=['encoder_config', 'type', 'skip', 'conv_dropout', 'conv_activation', 'height', 'width', 'num_channels', 'out_channels', 'kernel_size', 'stride', 'padding_mode', 'padding', 'dilation', 'groups', 'pool_function', 'pool_kernel_size', 'pool_stride', 'pool_padding', 'pool_dilation', 'output_size', 'conv_use_bias', 'conv_norm', 'conv_norm_params', 'num_conv_layers', 'conv_layers', 'fc_dropout', 'fc_activation', 'fc_use_bias', 'fc_bias_initializer', 'fc_weights_initializer', 'fc_norm', 'fc_norm_params', 'num_fc_layers', 'fc_layers']\nDETECTED MetaFormer model: caformer_s18_384\nMetaFormer encoder is being loaded and used.\nMetaFormerStackedCNN encoder instantiated\nUsing MetaFormer model: caformer_s18_384\nOverriding expected backbone size to 224x224 for compatibility (was 384x384)\nInitializing MetaFormerStackedCNN with model: caformer_s18_384\nInput: 3x96x96 -> Output: 128 (expected backbone size: 224x224)\nConfigured size adapter to requested input: 96x96\nMetaFormer backbone requested: caformer_s18_384, use_pretrained=True\nMetaFormer cfg present=True\nMetaFormer weights_url=https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLOADING MetaFormer pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLoading pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCREATING MetaFormer model: caformer_s18_384 (pretrained=True)\nDOWNLOADING weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nDOWNLOADING weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nWEIGHTS DOWNLOADED successfully from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nMetaFormer model CREATED: caformer_s18_384\nMetaFormer: pretrained weights loaded from https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nMetaFormer: pretrained weights loaded from https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLoaded MetaFormer backbone: caformer_s18_384 (pretrained=True)\nMetaFormer feature dimension: 512\nMetaFormerStackedCNN initialized successfully\nCONFIRMED: MetaFormer 'caformer_s18_384' using pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCONFIRMED: MetaFormer 'caformer_s18_384' using pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCreating Augmentation pipline: [type: random_horizontal_flip\n, type: random_vertical_flip\n, type: random_rotate\ndegree: 10\n, type: random_blur\nkernel_size: 3\n, type: random_brightness\nmin: 0.5\nmax: 2.0\n, type: random_contrast\nmin: 0.5\nmax: 2.0\n]\nTuning batch size...\nTuning batch size...\nExploring batch_size=1\nAligning to MetaFormer backbone size: 224x224\nThroughput at batch_size=1: 6.07190 samples/s\nExploring batch_size=2\nThroughput at batch_size=2: 10.92807 samples/s\nExploring batch_size=4\nThroughput at batch_size=4: 17.53778 samples/s\nExploring batch_size=8\nThroughput at batch_size=8: 26.10411 samples/s\nExploring batch_size=16\nThroughput at batch_size=16: 42.46649 samples/s\nExplor\n..\nvaluation:   0%|          | 0/71 [00:00<?, ?it/s]\rEvaluation:   1%|▏         | 1/71 [00:00<00:08,  7.99it/s]\rEvaluation:   3%|▎         | 2/71 [00:00<00:08,  8.48it/s]\rEvaluation:   4%|▍         | 3/71 [00:00<00:08,  8.46it/s]\rEvaluation:   6%|▌         | 4/71 [00:00<00:07,  8.47it/s]\rEvaluation:   7%|▋         | 5/71 [00:00<00:07,  8.52it/s]\rEvaluation:   8%|▊         | 6/71 [00:00<00:07,  8.62it/s]\rEvaluation:  10%|▉         | 7/71 [00:00<00:07,  8.69it/s]\rEvaluation:  11%|█▏        | 8/71 [00:00<00:07,  8.73it/s]\rEvaluation:  13%|█▎        | 9/71 [00:01<00:07,  8.75it/s]\rEvaluation:  14%|█▍        | 10/71 [00:01<00:07,  8.71it/s]\rEvaluation:  15%|█▌        | 11/71 [00:01<00:06,  8.76it/s]\rEvaluation:  17%|█▋        | 12/71 [00:01<00:06,  8.70it/s]\rEvaluation:  18%|█▊        | 13/71 [00:01<00:06,  8.74it/s]\rEvaluation:  20%|█▉        | 14/71 [00:01<00:06,  8.66it/s]\rEvaluation:  21%|██        | 15/71 [00:01<00:06,  8.52it/s]\rEvaluation:  23%|██▎       | 16/71 [00:01<00:06,  8.43it/s]\rEvaluation:  24%|██▍       | 17/71 [00:01<00:06,  8.55it/s]\rEvaluation:  25%|██▌       | 18/71 [00:02<00:06,  8.77it/s]\rEvaluation:  28%|██▊       | 20/71 [00:02<00:05,  9.66it/s]\rEvaluation:  31%|███       | 22/71 [00:02<00:04, 10.16it/s]\rEvaluation:  34%|███▍      | 24/71 [00:02<00:04, 10.42it/s]\rEvaluation:  37%|███▋      | 26/71 [00:02<00:04, 10.62it/s]\rEvaluation:  39%|███▉      | 28/71 [00:02<00:04, 10.74it/s]\rEvaluation:  42%|████▏     | 30/71 [00:03<00:03, 10.81it/s]\rEvaluation:  45%|████▌     | 32/71 [00:03<00:03, 10.51it/s]\rEvaluation:  48%|████▊     | 34/71 [00:03<00:03,  9.79it/s]\rEvaluation:  49%|████▉     | 35/71 [00:03<00:03,  9.75it/s]\rEvaluation:  52%|█████▏    | 37/71 [00:03<00:03, 10.21it/s]\rEvaluation:  55%|█████▍    | 39/71 [00:04<00:03, 10.41it/s]\rEvaluation:  58%|█████▊    | 41/71 [00:04<00:03,  9.87it/s]\rEvaluation:  59%|█████▉    | 42/71 [00:04<00:03,  9.66it/s]\rEvaluation:  61%|██████    | 43/71 [00:04<00:02,  9.48it/s]\rEvaluation:  62%|██████▏   | 44/71 [00:04<00:02,  9.27it/s]\rEvaluation:  63%|██████▎   | 45/71 [00:04<00:02,  9.16it/s]\rEvaluation:  65%|██████▍   | 46/71 [00:04<00:02,  9.11it/s]\rEvaluation:  66%|██████▌   | 47/71 [00:04<00:02,  9.07it/s]\rEvaluation:  68%|██████▊   | 48/71 [00:05<00:02,  9.03it/s]\rEvaluation:  69%|██████▉   | 49/71 [00:05<00:02,  8.93it/s]\rEvaluation:  70%|███████   | 50/71 [00:05<00:02,  8.87it/s]\rEvaluation:  72%|███████▏  | 51/71 [00:05<00:02,  8.90it/s]\rEvaluation:  73%|███████▎  | 52/71 [00:05<00:02,  8.85it/s]\rEvaluation:  75%|███████▍  | 53/71 [00:05<00:02,  8.83it/s]\rEvaluation:  76%|███████▌  | 54/71 [00:05<00:01,  8.69it/s]\rEvaluation:  77%|███████▋  | 55/71 [00:05<00:01,  8.54it/s]\rEvaluation:  79%|███████▉  | 56/71 [00:06<00:01,  8.59it/s]\rEvaluation:  80%|████████  | 57/71 [00:06<00:01,  8.62it/s]\rEvaluation:  82%|████████▏ | 58/71 [00:06<00:01,  8.60it/s]\rEvaluation:  83%|████████▎ | 59/71 [00:06<00:01,  8.59it/s]\rEvaluation:  85%|████████▍ | 60/71 [00:06<00:01,  8.67it/s]\rEvaluation:  86%|████████▌ | 61/71 [00:06<00:01,  8.65it/s]\rEvaluation:  87%|████████▋ | 62/71 [00:06<00:01,  8.68it/s]\rEvaluation:  89%|████████▊ | 63/71 [00:06<00:00,  8.62it/s]\rEvaluation:  90%|█████████ | 64/71 [00:06<00:00,  8.62it/s]\rEvaluation:  92%|█████████▏| 65/71 [00:07<00:00,  8.62it/s]\rEvaluation:  93%|█████████▎| 66/71 [00:07<00:00,  8.65it/s]\rEvaluation:  94%|█████████▍| 67/71 [00:07<00:00,  8.77it/s]\rEvaluation:  96%|█████████▌| 68/71 [00:07<00:00,  8.72it/s]\rEvaluation:  97%|█████████▋| 69/71 [00:07<00:00,  8.73it/s]\rEvaluation:  99%|█████████▊| 70/71 [00:07<00:00,  8.79it/s]\rEvaluation: 100%|██████████| 71/71 [00:07<00:00,  8.92it/s]\rEvaluation: 100%|██████████| 71/71 [00:07<00:00,  9.17it/s]\n\n===== label =====\naccuracy: 0.7153061628341675\naccuracy_micro: 0.716312050819397\nhits_at_k: 0.9214285612106323\nloss: 1.9140996932983398\noverall_stats: { 'avg_f1_score_macro': 0.7178051880333712,\n  'avg_f1_score_micro': 0.7163120567375887,\n  'avg_f1_score_weighted': 0.7192610159414815,\n  'avg_precision_macro': 0.730907110318875,\n  'avg_precision_micro': 0.7163120567375887,\n  'avg_precision_weighted': 0.7163120567375887,\n  'avg_recall_macro': 0.7153061224489796,\n  'avg_recall_micro': 0.7163120567375887,\n  'avg_recall_weighted': 0.7163120567375887,\n  'kappa_score': 0.6690723464178842,\n  'token_accuracy': 0.7163120567375887}\nper_class_stats: {bkl: {   'accuracy': 0.8865248226950354,\n    'f1_score': 0.6595744680851063,\n    'fall_out': 0.0950413223140496,\n    'false_discovery_rate': 0.42592592592592593,\n    'false_negative_rate': 0.22499999999999998,\n    'false_negatives': 9,\n    'false_omission_rate': 0.03947368421052633,\n    'false_positive_rate': 0.0950413223140496,\n    'false_positives': 23,\n    'hit_rate': 0.775,\n    'informedness': 0.6799586776859505,\n    'markedness': 0.5346003898635479,\n    'matthews_correlation_coefficient': 0.602914732099002,\n    'miss_rate': 0.22499999999999998,\n    'negative_predictive_value': 0.9605263157894737,\n    'positive_predictive_value': 0.5740740740740741,\n    'precision': 0.5740740740740741,\n    'recall': 0.775,\n    'sensitivity': 0.775,\n    'specificity': 0.9049586776859504,\n    'true_negative_rate': 0.9049586776859504,\n    'true_negatives': 219,\n    'true_positive_rate': 0.775,\n    'true_positives': 31},\n  df: {   'accuracy': 0.9290780141843972,\n    'f1_score': 0.7368421052631577,\n    'fall_out': 0.03305785123966942,\n    'false_discovery_rate': 0.2222222222222222,\n    'false_negative_rate': 0.30000000000000004,\n    'false_negatives': 12,\n    'false_omission_rate': 0.04878048780487809,\n    'false_positive_rate': 0.03305785123966942,\n    'false_positives': 8,\n    'hit_rate': 0.7,\n    'informedness': 0.6669421487603304,\n    'markedness': 0.7289972899728996,\n    'matthews_correlation_coefficient': 0.697279727953555,\n    'miss_rate': 0.30000000000000004,\n    'negative_predictive_value': 0.9512195121951219,\n    'positive_predictive_value': 0.7777777777777778,\n    'precision': 0.7777777777777778,\n    'recall': 0.7,\n    'sensitivity': 0.7,\n    'specificity': 0.9669421487603306,\n    'true_negative_rate': 0.9669421487603306,\n    'true_negatives': 234,\n    'true_positive_rate': 0.7,\n    'true_positives': 28},\n  mel: {   'accuracy': 0.8829787234042553,\n    'f1_score': 0.6117647058823529,\n    'fall_out': 0.07851239669421484,\n    'false_discovery_rate': 0.4222222222222223,\n    'false_negative_rate': 0.35,\n    'false_negatives': 14,\n    'false_omission_rate': 0.05907172995780585,\n    'false_positive_rate': 0.07851239669421484,\n    'false_positives': 19,\n    'hit_rate': 0.65,\n    'informedness': 0.5714876033057852,\n    'markedness': 0.5187060478199719,\n    'matthews_correlation_coefficient': 0.5444575980632943,\n    'miss_rate': 0.35,\n    'negative_predictive_value': 0.9409282700421941,\n    'positive_predictive_value': 0.5777777777777777,\n    'precision': 0.5777777777777777,\n    'recall': 0.65,\n    'sensitivity': 0.65,\n    'specificity': 0.9214876033057852,\n    'true_negative_rate': 0.9214876033057852,\n    'true_negatives': 223,\n    'true_positive_rate': 0.65,\n    'true_positives': 26},\n  vasc: {   'accuracy': 0.9787234042553191,\n    'f1_score': 0.923076923076923,\n    'fall_out': 0.0,\n    'false_discovery_rate': 0.0,\n    'false_negative_rate': 0.1428571428571429,\n    'false_negatives': 6,\n    'false_omission_rate': 0.024390243902439046,\n    'false_positive_rate': 0.0,\n    'false_positives': 0,\n    'hit_rate': 0.8571428571428571,\n    'informedness': 0.8571428571428572,\n    'markedness': 0.975609756097561,\n    'matthews_correlation_coefficient': 0.9144599137184252,\n    'miss_rate': 0.1428571428571429,\n    'negative_predictive_value': 0.975609756097561,\n    'positive_predictive_value': 1.0,\n    'precision': 1.0,\n    'recall': 0.8571428571428571,\n    'sensitivity': 0.8571428571428571,\n    'specificity': 1.0,\n    'true_negative_rate': 1.0,\n    'true_negatives': 240,\n    'true_positive_rate': 0.8571428571428571,\n    'true_positives': 36},\n  bcc: {   'accuracy': 0.9397163120567376,\n    'f1_score': 0.7671232876712328,\n    'fall_out': 0.02066115702479343,\n    'false_discovery_rate': 0.1515151515151515,\n    'false_negative_rate': 0.30000000000000004,\n    'false_negatives': 12,\n    'false_omission_rate': 0.048192771084337394,\n    'false_positive_rate': 0.02066115702479343,\n    'false_positives': 5,\n    'hit_rate': 0.7,\n    'informedness': 0.6793388429752065,\n    'markedness': 0.8002920774005111,\n    'matthews_correlation_coefficient': 0.7373394699210721,\n    'miss_rate': 0.30000000000000004,\n    'negative_predictive_value': 0.9518072289156626,\n    'positive_predictive_value': 0.8484848484848485,\n    'precision': 0.8484848484848485,\n    'recall': 0.7,\n    'sensitivity': 0.7,\n    'specificity': 0.9793388429752066,\n    'true_negative_rate': 0.9793388429752066,\n    'true_negatives': 237,\n    'true_positive_rate': 0.7,\n    'true_positives': 28},\n  nv: {   'accuracy': 0.9361702127659575,\n    'f1_score': 0.7857142857142856,\n    'fall_out': 0.045454545454545414,\n    'false_discovery_rate': 0.25,\n    'false_negative_rate': 0.17500000000000004,\n    'false_negatives': 7,\n    'false_omission_rate': 0.02941176470588236,\n    'false_positive_rate': 0.045454545454545414,\n    'false_positives': 11,\n    'hit_rate': 0.825,\n    'informedness': 0.7795454545454545,\n    'markedness': 0.7205882352941178,\n    'matthews_correlation_coefficient': 0.7494873470729575,\n    'miss_rate': 0.17500000000000004,\n    'negative_predictive_value': 0.9705882352941176,\n    'positive_predictive_value': 0.75,\n    'precision': 0.75,\n    'recall': 0.825,\n    'sensitivity': 0.825,\n    'specificity': 0.9545454545454546,\n    'true_negative_rate': 0.9545454545454546,\n    'true_negatives': 231,\n    'true_positive_rate': 0.825,\n    'true_positives': 33},\n  akiec: {   'accuracy': 0.8794326241134752,\n    'f1_score': 0.5405405405405405,\n    'fall_out': 0.05785123966942152,\n    'false_discovery_rate': 0.4117647058823529,\n    'false_negative_rate': 0.5,\n    'false_negatives': 20,\n    'false_omission_rate': 0.08064516129032262,\n    'false_positive_rate': 0.05785123966942152,\n    'false_positives': 14,\n    'hit_rate': 0.5,\n    'informedness': 0.4421487603305785,\n    'markedness': 0.5075901328273245,\n    'matthews_correlation_coefficient': 0.4737408025340811,\n    'miss_rate': 0.5,\n    'negative_predictive_value': 0.9193548387096774,\n    'positive_predictive_value': 0.5882352941176471,\n    'precision': 0.5882352941176471,\n    'recall': 0.5,\n    'sensitivity': 0.5,\n    'specificity': 0.9421487603305785,\n    'true_negative_rate': 0.9421487603305785,\n    'true_negatives': 228,\n    'true_positive_rate': 0.5,\n    'true_positives': 20}}\nroc_auc: 0.9322562217712402\nSaved to: /jetstream2/scratch/main/jobs/74484141/working/experiment_run\nLudwigDirectBackend: Experiment completed. Results in .\nWorkflow completed successfully.\nConverted Parquet to CSV: experiment_run/predictions.csv\nConverted Parquet to CSV.\nGenerating Ludwig visualizations (train/val + test)…\n✔ Generated compare_performance\n✘ Skipped compare_classifiers_multiclass_multimetric: compare_classifiers_multiclass_multimetric() missing 2 required positional arguments: 'output_feature_name' and 'top_n_classes'\n✘ Skipped confidence_thresholding: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped confidence_thresholding_data_vs_acc: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped confidence_thresholding_data_vs_acc_subset: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped confidence_thresholding_data_vs_acc_subset_per_class: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped binary_threshold_vs_metric: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped roc_curves: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped precision_recall_curves: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped calibration_1_vs_all: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped calibration_multiclass: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped confusion_matrix: confusion_matrix() missing 3 required positional arguments: 'output_feature_name', 'top_n_classes', and 'normalize'\n✘ Skipped frequency_vs_f1: frequency_vs_f1() missing 2 required positional arguments: 'output_feature_name' and 'top_n_classes'\n✔ Generated learning_curves\nAll visualizations written to experiment_run/visualizations\nAdded 5 train/val diagnostic plots\nRecovered MetaFormer model from env: caformer_s18_384\npatched Stacked2DCNN init called; custom_model=caformer_s18_384 kwargs_keys=['encoder_config', 'type', 'skip', 'conv_dropout', 'conv_activation', 'height', 'width', 'num_channels', 'out_channels', 'kernel_size', 'stride', 'padding_mode', 'padding', 'dilation', 'groups', 'pool_function', 'pool_kernel_size', 'pool_stride', 'pool_padding', 'pool_dilation', 'output_size', 'conv_use_bias', 'conv_norm', 'conv_norm_params', 'num_conv_layers', 'conv_layers', 'fc_dropout', 'fc_activation', 'fc_use_bias', 'fc_bias_initializer', 'fc_weights_initializer', 'fc_norm', 'fc_norm_params', 'num_fc_layers', 'fc_layers']\nDETECTED MetaFormer model: caformer_s18_384\nMetaFormer encoder is being loaded and used.\nMetaFormerStackedCNN encoder instantiated\nUsing MetaFormer model: caformer_s18_384\nOverriding expected backbone size to 224x224 for compatibility (was 384x384)\nInitializing MetaFormerStackedCNN with model: caformer_s18_384\nInput: 3x96x96 -> Output: 128 (expected backbone size: 224x224)\nConfigured size adapter to requested input: 96x96\nMetaFormer backbone requested: caformer_s18_384, use_pretrained=True\nMetaFormer cfg present=True\nMetaFormer weights_url=https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLOADING MetaFormer pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLoading pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCREATING MetaFormer model: caformer_s18_384 (pretrained=True)\nDOWNLOADING weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nDOWNLOADING weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nWEIGHTS DOWNLOADED successfully from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nMetaFormer model CREATED: caformer_s18_384\nMetaFormer: pretrained weights loaded from https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nMetaFormer: pretrained weights loaded from https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLoaded MetaFormer backbone: caformer_s18_384 (pretrained=True)\nMetaFormer feature dimension: 512\nMetaFormerStackedCNN initialized successfully\nCONFIRMED: MetaFormer 'caformer_s18_384' using pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCONFIRMED: MetaFormer 'caformer_s18_384' using pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nAligning to MetaFormer backbone size: 224x224\nGenerated 2 interactive Plotly plots\nAdded multi-class per-class metric plots to test tab\nAdded test prediction confidence plot\nHTML report generated at: /jetstream2/scratch/main/jobs/74484141/working/image_classification_results_report.html\nHTML report generated at: /jetstream2/scratch/main/jobs/74484141/working/image_classification_results_report.html\nCleaning up temp directory: gleam_image_work_22ulxkps\nMain script finished successfully.\nImage Learner Classification Experiment is Done!\n","tool_stderr":"Downloading: \"https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\" to /jetstream2/scratch/main/jobs/74484141/working/torch_cache/checkpoints/caformer_s18_384.pth\n\r  0%|          | 0.00/101M [00:00<?, ?B/s]\r  1%|          | 1.20M/101M [00:00<00:08, 12.5MB/s]\r  7%|▋         | 7.17M/101M [00:00<00:02, 41.9MB/s]\r 19%|█▉        | 19.5M/101M [00:00<00:01, 81.5MB/s]\r 39%|███▉      | 39.0M/101M [00:00<00:00, 129MB/s] \r 59%|█████▊    | 59.0M/101M [00:00<00:00, 158MB/s]\r 80%|███████▉  | 80.0M/101M [00:00<00:00, 177MB/s]\r100%|██████████| 101M/101M [00:00<00:00, 153MB/s] \n","job_stdout":"","job_stderr":"","stdout":"MetaFormer models imported successfully\nPyTorch version 2.1.0+cu118 available.\ngenerated new fontManager\nLudwig visualizations available\nMetaFormer patching applied for Ludwig stacked_cnn encoder.\nOrchestrator initialized with backend: LudwigDirectBackend\nStarting workflow...\nCreated temp directory: gleam_image_work_22ulxkps\nPreparing images from /jetstream2/scratch/main/jobs/74484141/inputs/dataset_d4e20b36-bb9f-4cf1-befd-9d5161166830.dat → gleam_image_work_22ulxkps/images\nImage extraction complete.\nLoading metadata table from selected_HAM10000_img_metadata_aug.csv\nLoaded metadata file: selected_HAM10000_img_metadata_aug.csv\nTarget column '3' not found; using column #3 header 'dx' instead.\nImage column '8' not found; using column #8 header 'image_path' instead.\nSample ID column '1' not found; using column #1 header 'lesion_id' instead.\nNo split column; creating stratified random split\nUsing stratified random split for train/validation/test sets (grouped by 'lesion_id')\nSuccessfully applied stratified random split\nSplit counts: Train=978, Val=140, Test=282\nSaved prepared data to gleam_image_work_22ulxkps/processed_data_for_ludwig.csv\nLudwigDirectBackend: Preparing YAML configuration.\nDETECTED MetaFormer model: caformer_s18_384\nMetaFormer cfg lookup: model=caformer_s18_384 has_cfg=True url=https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth use_pretrained=True\nMetaFormer explicit resize: 384x384\nSet preprocessing dimensions for MetaFormer: 384x384 (infer_dimensions=True with max dimensions to allow validation)\nLudwigDirectBackend: YAML config generated.\nWrote backend config: gleam_image_work_22ulxkps/ludwig_config.yaml\nLudwigDirectBackend: Starting experiment execution.\nDisabled torchvision weight hash verification to avoid proxy-corrupted downloads.\n\n╒════════════════════════╕\n│ EXPERIMENT DESCRIPTION │\n╘════════════════════════╛\n\n╒══════════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════════════════╕\n│ Experiment name  │ experiment                                                                                                  │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ Model name       │ run                                                                                                         │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ Output directory │ /jetstream2/scratch/main/jobs/74484141/working/experiment_run                                               │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ ludwig_version   │ '0.10.1'                                                                                                    │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ command          │ ('/jetstream2/scratch/main/jobs/74484141/tool_files/image_learner_cli.py '                                  │\n│                  │  '--csv-file ./selected_HAM10000_img_metadata_aug.csv --image-zip '                                         │\n│                  │  '/jetstream2/scratch/main/jobs/74484141/inputs/dataset_d4e20b36-bb9f-4cf1-befd-9d5161166830.dat '          │\n│                  │  '--model-name caformer_s18_384 --use-pretrained --fine-tune --epochs 30 '                                  │\n│                  │  '--early-stop 30 --split-probabilities 0.7 0.1 0.2 --threshold 0.5 '                                       │\n│                  │  '--augmentation '                                                                                          │\n│                  │  'random_horizontal_flip,random_vertical_flip,random_rotate,random_blur,random_brightness,random_contrast ' │\n│                  │  '--target-column 3 --image-column 8 --sample-id-column 1 --image-resize '                                  │\n│                  │  '384x384 --random-seed 42 --torch-home ./torch_cache --output-dir .')                                      │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ random_seed      │ 42                                                                                                          │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ dataset          │ 'gleam_image_work_22ulxkps/processed_data_for_ludwig.csv'                                                   │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ data_format      │ 'csv'                                                                                                       │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ torch_version    │ '2.1.0+cu118'                                                                                               │\n├──────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ compute          │ {   'arch_list': [   'sm_50',                                                                               │\n│                  │                      'sm_60',                                                                               │\n│                  │                      'sm_70',                                                                               │\n│                  │                      'sm_75',                                                                               │\n│                  │                      'sm_80',                                                                               │\n│                  │                      'sm_86',                                                                               │\n│                  │                      'sm_37',                                                                               │\n│                  │                      'sm_90'],                                                                              │\n│                  │     'devices': {   0: {   'device_capability': (8, 0),                                                      │\n│                  │                           'device_properties': \"_CudaDeviceProperties(name='GRID \"                          │\n│                  │                                                \"A100X-20C', major=8, minor=0, \"                             │\n│                  │                                                'total_memory=20475MB, '                                     │\n│                  │                                                'multi_processor_count=108)',                                │\n│                  │                           'gpu_type': 'GRID A100X-20C'}},                                                   │\n│                  │     'gencode_flags': '-gencode compute=compute_50,code=sm_50 -gencode '                                     │\n│                  │                      'compute=compute_60,code=sm_60 -gencode '                                              │\n│                  │                      'compute=compute_70,code=sm_70 -gencode '                                              │\n│                  │                      'compute=compute_75,code=sm_75 -gencode '                                              │\n│                  │                      'compute=compute_80,code=sm_80 -gencode '                                              │\n│                  │                      'compute=compute_86,code=sm_86 -gencode '                                              │\n│                  │                      'compute=compute_37,code=sm_37 -gencode '                                              │\n│                  │                      'compute=compute_90,code=sm_90',                                                       │\n│                  │     'gpus_per_node': 1,                                                                                     │\n│                  │     'num_nodes': 1}                                                                                         │\n╘══════════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════════════════╛\n\n╒═══════════════╕\n│ LUDWIG CONFIG │\n╘═══════════════╛\n\nUser-specified config (with upgrades):\n\n{   'combiner': {'type': 'concat'},\n    'input_features': [   {   'augmentation': [   {   'type': 'random_horizontal_flip'},\n                                                  {   'type': 'random_vertical_flip'},\n                                                  {   'degree': 10,\n                                                      'type': 'random_rotate'},\n                                                  {   'kernel_size': 3,\n                                                      'type': 'random_blur'},\n                                                  {   'max': 2.0,\n                                                      'min': 0.5,\n                                                      'type': 'random_brightness'},\n                                                  {   'max': 2.0,\n                                                      'min': 0.5,\n                                                      'type': 'random_contrast'}],\n                              'encoder': {   'custom_model': 'caformer_s18_384',\n                                             'height': 384,\n                                             'num_channels': 3,\n                                             'output_size': 128,\n                                             'trainable': True,\n                                             'type': 'stacked_cnn',\n                                             'use_pretrained': True,\n                                             'width': 384},\n                              'name': 'image_path',\n                              'preprocessing': {   'height': 384,\n                                                   'infer_image_dimensions': True,\n                                                   'infer_image_max_height': 384,\n                                                   'infer_image_max_width': 384,\n                                                   'num_channels': 3,\n                                                   'requires_equal_dimensions': False,\n                                                   'resize_method': 'interpolate',\n                                                   'standardize_image': 'imagenet1k',\n                                                   'width': 384},\n                              'type': 'image'}],\n    'ludwig_version': '0.10.1',\n    'model_type': 'ecd',\n    'output_features': [   {   'loss': {   'class_weights': None,\n                                           'type': 'softmax_cross_entropy'},\n                               'name': 'label',\n                               'type': 'category'}],\n    'preprocessing': {   'in_memory': False,\n                         'num_processes': 8,\n                         'split': {'column': 'split', 'type': 'fixed'}},\n    'trainer': {   'batch_size': 'auto',\n                   'early_stop': 30,\n                   'epochs': 30,\n                   'learning_rate': 'auto',\n                   'validation_metric': 'accuracy'}}\n\nFull config saved to:\n/jetstream2/scratch/main/jobs/74484141/working/experiment_run/experiment/model/model_hyperparameters.json\n\n╒═══════════════╕\n│ PREPROCESSING │\n╘═══════════════╛\n\nNo cached dataset found at gleam_image_work_22ulxkps/processed_data_for_ludwig.training.hdf5. Preprocessing the dataset.\nUsing full raw dataset, no hdf5 and json file with the same name have been found\nBuilding dataset (it may take a while)\nBuilding dataset: DONE\nWriting preprocessed training set cache to gleam_image_work_22ulxkps/processed_data_for_ludwig.training.hdf5\nWriting preprocessed validation set cache to gleam_image_work_22ulxkps/processed_data_for_ludwig.validation.hdf5\nWriting preprocessed test set cache to gleam_image_work_22ulxkps/processed_data_for_ludwig.test.hdf5\nWriting train set metadata to gleam_image_work_22ulxkps/processed_data_for_ludwig.meta.json\n\nDataset Statistics\n╒════════════╤═══════════════╤════════════════════╕\n│ Dataset    │   Size (Rows) │ Size (In Memory)   │\n╞════════════╪═══════════════╪════════════════════╡\n│ Training   │           978 │ 146.25 Kb          │\n├────────────┼───────────────┼────────────────────┤\n│ Validation │           140 │ 21.04 Kb           │\n├────────────┼───────────────┼────────────────────┤\n│ Test       │           282 │ 42.26 Kb           │\n╘════════════╧═══════════════╧════════════════════╛\n\n╒═══════╕\n│ MODEL │\n╘═══════╛\n\nWarnings and other logs:\npatched Stacked2DCNN init called; custom_model=caformer_s18_384 kwargs_keys=['encoder_config', 'type', 'skip', 'conv_dropout', 'conv_activation', 'height', 'width', 'num_channels', 'out_channels', 'kernel_size', 'stride', 'padding_mode', 'padding', 'dilation', 'groups', 'pool_function', 'pool_kernel_size', 'pool_stride', 'pool_padding', 'pool_dilation', 'output_size', 'conv_use_bias', 'conv_norm', 'conv_norm_params', 'num_conv_layers', 'conv_layers', 'fc_dropout', 'fc_activation', 'fc_use_bias', 'fc_bias_initializer', 'fc_weights_initializer', 'fc_norm', 'fc_norm_params', 'num_fc_layers', 'fc_layers']\nDETECTED MetaFormer model: caformer_s18_384\nMetaFormer encoder is being loaded and used.\nMetaFormerStackedCNN encoder instantiated\nUsing MetaFormer model: caformer_s18_384\nOverriding expected backbone size to 224x224 for compatibility (was 384x384)\nInitializing MetaFormerStackedCNN with model: caformer_s18_384\nInput: 3x96x96 -> Output: 128 (expected backbone size: 224x224)\nConfigured size adapter to requested input: 96x96\nMetaFormer backbone requested: caformer_s18_384, use_pretrained=True\nMetaFormer cfg present=True\nMetaFormer weights_url=https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLOADING MetaFormer pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLoading pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCREATING MetaFormer model: caformer_s18_384 (pretrained=True)\nDOWNLOADING weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nDOWNLOADING weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nWEIGHTS DOWNLOADED successfully from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nMetaFormer model CREATED: caformer_s18_384\nMetaFormer: pretrained weights loaded from https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nMetaFormer: pretrained weights loaded from https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLoaded MetaFormer backbone: caformer_s18_384 (pretrained=True)\nMetaFormer feature dimension: 512\nMetaFormerStackedCNN initialized successfully\nCONFIRMED: MetaFormer 'caformer_s18_384' using pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCONFIRMED: MetaFormer 'caformer_s18_384' using pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCreating Augmentation pipline: [type: random_horizontal_flip\n, type: random_vertical_flip\n, type: random_rotate\ndegree: 10\n, type: random_blur\nkernel_size: 3\n, type: random_brightness\nmin: 0.5\nmax: 2.0\n, type: random_contrast\nmin: 0.5\nmax: 2.0\n]\nTuning batch size...\nTuning batch size...\nExploring batch_size=1\nAligning to MetaFormer backbone size: 224x224\nThroughput at batch_size=1: 6.07190 samples/s\nExploring batch_size=2\nThroughput at batch_size=2: 10.92807 samples/s\nExploring batch_size=4\nThroughput at batch_size=4: 17.53778 samples/s\nExploring batch_size=8\nThroughput at batch_size=8: 26.10411 samples/s\nExploring batch_size=16\nThroughput at batch_size=16: 42.46649 samples/s\nExplor\n..\nvaluation:   0%|          | 0/71 [00:00<?, ?it/s]\rEvaluation:   1%|▏         | 1/71 [00:00<00:08,  7.99it/s]\rEvaluation:   3%|▎         | 2/71 [00:00<00:08,  8.48it/s]\rEvaluation:   4%|▍         | 3/71 [00:00<00:08,  8.46it/s]\rEvaluation:   6%|▌         | 4/71 [00:00<00:07,  8.47it/s]\rEvaluation:   7%|▋         | 5/71 [00:00<00:07,  8.52it/s]\rEvaluation:   8%|▊         | 6/71 [00:00<00:07,  8.62it/s]\rEvaluation:  10%|▉         | 7/71 [00:00<00:07,  8.69it/s]\rEvaluation:  11%|█▏        | 8/71 [00:00<00:07,  8.73it/s]\rEvaluation:  13%|█▎        | 9/71 [00:01<00:07,  8.75it/s]\rEvaluation:  14%|█▍        | 10/71 [00:01<00:07,  8.71it/s]\rEvaluation:  15%|█▌        | 11/71 [00:01<00:06,  8.76it/s]\rEvaluation:  17%|█▋        | 12/71 [00:01<00:06,  8.70it/s]\rEvaluation:  18%|█▊        | 13/71 [00:01<00:06,  8.74it/s]\rEvaluation:  20%|█▉        | 14/71 [00:01<00:06,  8.66it/s]\rEvaluation:  21%|██        | 15/71 [00:01<00:06,  8.52it/s]\rEvaluation:  23%|██▎       | 16/71 [00:01<00:06,  8.43it/s]\rEvaluation:  24%|██▍       | 17/71 [00:01<00:06,  8.55it/s]\rEvaluation:  25%|██▌       | 18/71 [00:02<00:06,  8.77it/s]\rEvaluation:  28%|██▊       | 20/71 [00:02<00:05,  9.66it/s]\rEvaluation:  31%|███       | 22/71 [00:02<00:04, 10.16it/s]\rEvaluation:  34%|███▍      | 24/71 [00:02<00:04, 10.42it/s]\rEvaluation:  37%|███▋      | 26/71 [00:02<00:04, 10.62it/s]\rEvaluation:  39%|███▉      | 28/71 [00:02<00:04, 10.74it/s]\rEvaluation:  42%|████▏     | 30/71 [00:03<00:03, 10.81it/s]\rEvaluation:  45%|████▌     | 32/71 [00:03<00:03, 10.51it/s]\rEvaluation:  48%|████▊     | 34/71 [00:03<00:03,  9.79it/s]\rEvaluation:  49%|████▉     | 35/71 [00:03<00:03,  9.75it/s]\rEvaluation:  52%|█████▏    | 37/71 [00:03<00:03, 10.21it/s]\rEvaluation:  55%|█████▍    | 39/71 [00:04<00:03, 10.41it/s]\rEvaluation:  58%|█████▊    | 41/71 [00:04<00:03,  9.87it/s]\rEvaluation:  59%|█████▉    | 42/71 [00:04<00:03,  9.66it/s]\rEvaluation:  61%|██████    | 43/71 [00:04<00:02,  9.48it/s]\rEvaluation:  62%|██████▏   | 44/71 [00:04<00:02,  9.27it/s]\rEvaluation:  63%|██████▎   | 45/71 [00:04<00:02,  9.16it/s]\rEvaluation:  65%|██████▍   | 46/71 [00:04<00:02,  9.11it/s]\rEvaluation:  66%|██████▌   | 47/71 [00:04<00:02,  9.07it/s]\rEvaluation:  68%|██████▊   | 48/71 [00:05<00:02,  9.03it/s]\rEvaluation:  69%|██████▉   | 49/71 [00:05<00:02,  8.93it/s]\rEvaluation:  70%|███████   | 50/71 [00:05<00:02,  8.87it/s]\rEvaluation:  72%|███████▏  | 51/71 [00:05<00:02,  8.90it/s]\rEvaluation:  73%|███████▎  | 52/71 [00:05<00:02,  8.85it/s]\rEvaluation:  75%|███████▍  | 53/71 [00:05<00:02,  8.83it/s]\rEvaluation:  76%|███████▌  | 54/71 [00:05<00:01,  8.69it/s]\rEvaluation:  77%|███████▋  | 55/71 [00:05<00:01,  8.54it/s]\rEvaluation:  79%|███████▉  | 56/71 [00:06<00:01,  8.59it/s]\rEvaluation:  80%|████████  | 57/71 [00:06<00:01,  8.62it/s]\rEvaluation:  82%|████████▏ | 58/71 [00:06<00:01,  8.60it/s]\rEvaluation:  83%|████████▎ | 59/71 [00:06<00:01,  8.59it/s]\rEvaluation:  85%|████████▍ | 60/71 [00:06<00:01,  8.67it/s]\rEvaluation:  86%|████████▌ | 61/71 [00:06<00:01,  8.65it/s]\rEvaluation:  87%|████████▋ | 62/71 [00:06<00:01,  8.68it/s]\rEvaluation:  89%|████████▊ | 63/71 [00:06<00:00,  8.62it/s]\rEvaluation:  90%|█████████ | 64/71 [00:06<00:00,  8.62it/s]\rEvaluation:  92%|█████████▏| 65/71 [00:07<00:00,  8.62it/s]\rEvaluation:  93%|█████████▎| 66/71 [00:07<00:00,  8.65it/s]\rEvaluation:  94%|█████████▍| 67/71 [00:07<00:00,  8.77it/s]\rEvaluation:  96%|█████████▌| 68/71 [00:07<00:00,  8.72it/s]\rEvaluation:  97%|█████████▋| 69/71 [00:07<00:00,  8.73it/s]\rEvaluation:  99%|█████████▊| 70/71 [00:07<00:00,  8.79it/s]\rEvaluation: 100%|██████████| 71/71 [00:07<00:00,  8.92it/s]\rEvaluation: 100%|██████████| 71/71 [00:07<00:00,  9.17it/s]\n\n===== label =====\naccuracy: 0.7153061628341675\naccuracy_micro: 0.716312050819397\nhits_at_k: 0.9214285612106323\nloss: 1.9140996932983398\noverall_stats: { 'avg_f1_score_macro': 0.7178051880333712,\n  'avg_f1_score_micro': 0.7163120567375887,\n  'avg_f1_score_weighted': 0.7192610159414815,\n  'avg_precision_macro': 0.730907110318875,\n  'avg_precision_micro': 0.7163120567375887,\n  'avg_precision_weighted': 0.7163120567375887,\n  'avg_recall_macro': 0.7153061224489796,\n  'avg_recall_micro': 0.7163120567375887,\n  'avg_recall_weighted': 0.7163120567375887,\n  'kappa_score': 0.6690723464178842,\n  'token_accuracy': 0.7163120567375887}\nper_class_stats: {bkl: {   'accuracy': 0.8865248226950354,\n    'f1_score': 0.6595744680851063,\n    'fall_out': 0.0950413223140496,\n    'false_discovery_rate': 0.42592592592592593,\n    'false_negative_rate': 0.22499999999999998,\n    'false_negatives': 9,\n    'false_omission_rate': 0.03947368421052633,\n    'false_positive_rate': 0.0950413223140496,\n    'false_positives': 23,\n    'hit_rate': 0.775,\n    'informedness': 0.6799586776859505,\n    'markedness': 0.5346003898635479,\n    'matthews_correlation_coefficient': 0.602914732099002,\n    'miss_rate': 0.22499999999999998,\n    'negative_predictive_value': 0.9605263157894737,\n    'positive_predictive_value': 0.5740740740740741,\n    'precision': 0.5740740740740741,\n    'recall': 0.775,\n    'sensitivity': 0.775,\n    'specificity': 0.9049586776859504,\n    'true_negative_rate': 0.9049586776859504,\n    'true_negatives': 219,\n    'true_positive_rate': 0.775,\n    'true_positives': 31},\n  df: {   'accuracy': 0.9290780141843972,\n    'f1_score': 0.7368421052631577,\n    'fall_out': 0.03305785123966942,\n    'false_discovery_rate': 0.2222222222222222,\n    'false_negative_rate': 0.30000000000000004,\n    'false_negatives': 12,\n    'false_omission_rate': 0.04878048780487809,\n    'false_positive_rate': 0.03305785123966942,\n    'false_positives': 8,\n    'hit_rate': 0.7,\n    'informedness': 0.6669421487603304,\n    'markedness': 0.7289972899728996,\n    'matthews_correlation_coefficient': 0.697279727953555,\n    'miss_rate': 0.30000000000000004,\n    'negative_predictive_value': 0.9512195121951219,\n    'positive_predictive_value': 0.7777777777777778,\n    'precision': 0.7777777777777778,\n    'recall': 0.7,\n    'sensitivity': 0.7,\n    'specificity': 0.9669421487603306,\n    'true_negative_rate': 0.9669421487603306,\n    'true_negatives': 234,\n    'true_positive_rate': 0.7,\n    'true_positives': 28},\n  mel: {   'accuracy': 0.8829787234042553,\n    'f1_score': 0.6117647058823529,\n    'fall_out': 0.07851239669421484,\n    'false_discovery_rate': 0.4222222222222223,\n    'false_negative_rate': 0.35,\n    'false_negatives': 14,\n    'false_omission_rate': 0.05907172995780585,\n    'false_positive_rate': 0.07851239669421484,\n    'false_positives': 19,\n    'hit_rate': 0.65,\n    'informedness': 0.5714876033057852,\n    'markedness': 0.5187060478199719,\n    'matthews_correlation_coefficient': 0.5444575980632943,\n    'miss_rate': 0.35,\n    'negative_predictive_value': 0.9409282700421941,\n    'positive_predictive_value': 0.5777777777777777,\n    'precision': 0.5777777777777777,\n    'recall': 0.65,\n    'sensitivity': 0.65,\n    'specificity': 0.9214876033057852,\n    'true_negative_rate': 0.9214876033057852,\n    'true_negatives': 223,\n    'true_positive_rate': 0.65,\n    'true_positives': 26},\n  vasc: {   'accuracy': 0.9787234042553191,\n    'f1_score': 0.923076923076923,\n    'fall_out': 0.0,\n    'false_discovery_rate': 0.0,\n    'false_negative_rate': 0.1428571428571429,\n    'false_negatives': 6,\n    'false_omission_rate': 0.024390243902439046,\n    'false_positive_rate': 0.0,\n    'false_positives': 0,\n    'hit_rate': 0.8571428571428571,\n    'informedness': 0.8571428571428572,\n    'markedness': 0.975609756097561,\n    'matthews_correlation_coefficient': 0.9144599137184252,\n    'miss_rate': 0.1428571428571429,\n    'negative_predictive_value': 0.975609756097561,\n    'positive_predictive_value': 1.0,\n    'precision': 1.0,\n    'recall': 0.8571428571428571,\n    'sensitivity': 0.8571428571428571,\n    'specificity': 1.0,\n    'true_negative_rate': 1.0,\n    'true_negatives': 240,\n    'true_positive_rate': 0.8571428571428571,\n    'true_positives': 36},\n  bcc: {   'accuracy': 0.9397163120567376,\n    'f1_score': 0.7671232876712328,\n    'fall_out': 0.02066115702479343,\n    'false_discovery_rate': 0.1515151515151515,\n    'false_negative_rate': 0.30000000000000004,\n    'false_negatives': 12,\n    'false_omission_rate': 0.048192771084337394,\n    'false_positive_rate': 0.02066115702479343,\n    'false_positives': 5,\n    'hit_rate': 0.7,\n    'informedness': 0.6793388429752065,\n    'markedness': 0.8002920774005111,\n    'matthews_correlation_coefficient': 0.7373394699210721,\n    'miss_rate': 0.30000000000000004,\n    'negative_predictive_value': 0.9518072289156626,\n    'positive_predictive_value': 0.8484848484848485,\n    'precision': 0.8484848484848485,\n    'recall': 0.7,\n    'sensitivity': 0.7,\n    'specificity': 0.9793388429752066,\n    'true_negative_rate': 0.9793388429752066,\n    'true_negatives': 237,\n    'true_positive_rate': 0.7,\n    'true_positives': 28},\n  nv: {   'accuracy': 0.9361702127659575,\n    'f1_score': 0.7857142857142856,\n    'fall_out': 0.045454545454545414,\n    'false_discovery_rate': 0.25,\n    'false_negative_rate': 0.17500000000000004,\n    'false_negatives': 7,\n    'false_omission_rate': 0.02941176470588236,\n    'false_positive_rate': 0.045454545454545414,\n    'false_positives': 11,\n    'hit_rate': 0.825,\n    'informedness': 0.7795454545454545,\n    'markedness': 0.7205882352941178,\n    'matthews_correlation_coefficient': 0.7494873470729575,\n    'miss_rate': 0.17500000000000004,\n    'negative_predictive_value': 0.9705882352941176,\n    'positive_predictive_value': 0.75,\n    'precision': 0.75,\n    'recall': 0.825,\n    'sensitivity': 0.825,\n    'specificity': 0.9545454545454546,\n    'true_negative_rate': 0.9545454545454546,\n    'true_negatives': 231,\n    'true_positive_rate': 0.825,\n    'true_positives': 33},\n  akiec: {   'accuracy': 0.8794326241134752,\n    'f1_score': 0.5405405405405405,\n    'fall_out': 0.05785123966942152,\n    'false_discovery_rate': 0.4117647058823529,\n    'false_negative_rate': 0.5,\n    'false_negatives': 20,\n    'false_omission_rate': 0.08064516129032262,\n    'false_positive_rate': 0.05785123966942152,\n    'false_positives': 14,\n    'hit_rate': 0.5,\n    'informedness': 0.4421487603305785,\n    'markedness': 0.5075901328273245,\n    'matthews_correlation_coefficient': 0.4737408025340811,\n    'miss_rate': 0.5,\n    'negative_predictive_value': 0.9193548387096774,\n    'positive_predictive_value': 0.5882352941176471,\n    'precision': 0.5882352941176471,\n    'recall': 0.5,\n    'sensitivity': 0.5,\n    'specificity': 0.9421487603305785,\n    'true_negative_rate': 0.9421487603305785,\n    'true_negatives': 228,\n    'true_positive_rate': 0.5,\n    'true_positives': 20}}\nroc_auc: 0.9322562217712402\nSaved to: /jetstream2/scratch/main/jobs/74484141/working/experiment_run\nLudwigDirectBackend: Experiment completed. Results in .\nWorkflow completed successfully.\nConverted Parquet to CSV: experiment_run/predictions.csv\nConverted Parquet to CSV.\nGenerating Ludwig visualizations (train/val + test)…\n✔ Generated compare_performance\n✘ Skipped compare_classifiers_multiclass_multimetric: compare_classifiers_multiclass_multimetric() missing 2 required positional arguments: 'output_feature_name' and 'top_n_classes'\n✘ Skipped confidence_thresholding: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped confidence_thresholding_data_vs_acc: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped confidence_thresholding_data_vs_acc_subset: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped confidence_thresholding_data_vs_acc_subset_per_class: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped binary_threshold_vs_metric: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped roc_curves: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped precision_recall_curves: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped calibration_1_vs_all: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped calibration_multiclass: Could not open Parquet input source '<Buffer>': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\n✘ Skipped confusion_matrix: confusion_matrix() missing 3 required positional arguments: 'output_feature_name', 'top_n_classes', and 'normalize'\n✘ Skipped frequency_vs_f1: frequency_vs_f1() missing 2 required positional arguments: 'output_feature_name' and 'top_n_classes'\n✔ Generated learning_curves\nAll visualizations written to experiment_run/visualizations\nAdded 5 train/val diagnostic plots\nRecovered MetaFormer model from env: caformer_s18_384\npatched Stacked2DCNN init called; custom_model=caformer_s18_384 kwargs_keys=['encoder_config', 'type', 'skip', 'conv_dropout', 'conv_activation', 'height', 'width', 'num_channels', 'out_channels', 'kernel_size', 'stride', 'padding_mode', 'padding', 'dilation', 'groups', 'pool_function', 'pool_kernel_size', 'pool_stride', 'pool_padding', 'pool_dilation', 'output_size', 'conv_use_bias', 'conv_norm', 'conv_norm_params', 'num_conv_layers', 'conv_layers', 'fc_dropout', 'fc_activation', 'fc_use_bias', 'fc_bias_initializer', 'fc_weights_initializer', 'fc_norm', 'fc_norm_params', 'num_fc_layers', 'fc_layers']\nDETECTED MetaFormer model: caformer_s18_384\nMetaFormer encoder is being loaded and used.\nMetaFormerStackedCNN encoder instantiated\nUsing MetaFormer model: caformer_s18_384\nOverriding expected backbone size to 224x224 for compatibility (was 384x384)\nInitializing MetaFormerStackedCNN with model: caformer_s18_384\nInput: 3x96x96 -> Output: 128 (expected backbone size: 224x224)\nConfigured size adapter to requested input: 96x96\nMetaFormer backbone requested: caformer_s18_384, use_pretrained=True\nMetaFormer cfg present=True\nMetaFormer weights_url=https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLOADING MetaFormer pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLoading pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCREATING MetaFormer model: caformer_s18_384 (pretrained=True)\nDOWNLOADING weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nDOWNLOADING weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nWEIGHTS DOWNLOADED successfully from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nMetaFormer model CREATED: caformer_s18_384\nMetaFormer: pretrained weights loaded from https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nMetaFormer: pretrained weights loaded from https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nLoaded MetaFormer backbone: caformer_s18_384 (pretrained=True)\nMetaFormer feature dimension: 512\nMetaFormerStackedCNN initialized successfully\nCONFIRMED: MetaFormer 'caformer_s18_384' using pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nCONFIRMED: MetaFormer 'caformer_s18_384' using pretrained weights from: https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\nAligning to MetaFormer backbone size: 224x224\nGenerated 2 interactive Plotly plots\nAdded multi-class per-class metric plots to test tab\nAdded test prediction confidence plot\nHTML report generated at: /jetstream2/scratch/main/jobs/74484141/working/image_classification_results_report.html\nHTML report generated at: /jetstream2/scratch/main/jobs/74484141/working/image_classification_results_report.html\nCleaning up temp directory: gleam_image_work_22ulxkps\nMain script finished successfully.\nImage Learner Classification Experiment is Done!\n","stderr":"Downloading: \"https://huggingface.co/sail/dl/resolve/main/caformer/caformer_s18_384.pth\" to /jetstream2/scratch/main/jobs/74484141/working/torch_cache/checkpoints/caformer_s18_384.pth\n\r  0%|          | 0.00/101M [00:00<?, ?B/s]\r  1%|          | 1.20M/101M [00:00<00:08, 12.5MB/s]\r  7%|▋         | 7.17M/101M [00:00<00:02, 41.9MB/s]\r 19%|█▉        | 19.5M/101M [00:00<00:01, 81.5MB/s]\r 39%|███▉      | 39.0M/101M [00:00<00:00, 129MB/s] \r 59%|█████▊    | 59.0M/101M [00:00<00:00, 158MB/s]\r 80%|███████▉  | 80.0M/101M [00:00<00:00, 177MB/s]\r100%|██████████| 101M/101M [00:00<00:00, 153MB/s] \n","job_messages":[],"dependencies":[],"job_metrics":null}